2025-06-17 23:39:20,382 - INFO - 
Summary for table: casts
2025-06-17 23:39:20,915 - INFO - 
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 1155722 entries, 0 to 1155721
Data columns (total 9 columns):
 #   Column        Non-Null Count    Dtype         
---  ------        --------------    -----         
 0   latitude      1155722 non-null  object        
 1   longitude     1155722 non-null  object        
 2   year          1155722 non-null  object        
 3   month         1155722 non-null  object        
 4   day           1155722 non-null  object        
 5   time          1117111 non-null  object        
 6   bottom depth  612207 non-null   object        
 7   cast          1155722 non-null  int32         
 8   timestamp     1155722 non-null  datetime64[us]
dtypes: datetime64[us](1), int32(1), object(7)
memory usage: 74.9+ MB

2025-06-17 23:39:21,694 - INFO - 
       latitude longitude     year    month      day     time bottom depth          cast                   timestamp
count   1155722   1155722  1155722  1155722  1155722  1117111       612207  1.155722e+06                     1155722
unique   363924    492058       63       12       32    54477        20594           NaN                         NaN
top       58.10    -12.05     1999        8        6      0.0          42.           NaN                         NaN
freq       3866      3791    35874   130226    40933     4549         4220           NaN                         NaN
mean        NaN       NaN      NaN      NaN      NaN      NaN          NaN  1.183909e+07  2000-02-27 04:21:26.013696
min         NaN       NaN      NaN      NaN      NaN      NaN          NaN  6.058060e+05         1961-01-20 21:00:00
25%         NaN       NaN      NaN      NaN      NaN      NaN          NaN  8.603496e+06         1991-05-01 00:00:00
50%         NaN       NaN      NaN      NaN      NaN      NaN          NaN  1.150105e+07  2000-02-07 12:02:24.540000
75%         NaN       NaN      NaN      NaN      NaN      NaN          NaN  1.579440e+07         2010-06-29 15:18:36
max         NaN       NaN      NaN      NaN      NaN      NaN          NaN  2.282467e+07         2024-12-21 22:57:00
std         NaN       NaN      NaN      NaN      NaN      NaN          NaN  5.088502e+06                         NaN
2025-06-17 23:39:21,739 - INFO - 
Summary for table: features
2025-06-17 23:39:24,460 - INFO - 
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 30692009 entries, 0 to 30692008
Data columns (total 9 columns):
 #   Column          Dtype  
---  ------          -----  
 0   chlorophyll     float64
 1   depth           float64
 2   nitrate         float64
 3   oxygen          float64
 4   ph              float64
 5   salinity        float64
 6   temperature     float64
 7   transmissivity  float64
 8   cast            int32  
dtypes: float64(8), int32(1)
memory usage: 1.9 GB

2025-06-17 23:39:29,304 - INFO - 
        chlorophyll         depth       nitrate        oxygen           ph      salinity   temperature  transmissivity          cast
count  2.213716e+06  2.953713e+07  13133.000000  7.099224e+06  2652.000000  2.869015e+07  2.951922e+07   254676.000000  3.069201e+07
mean   9.665283e-01  3.754633e+02     14.408317  2.032742e+02     8.009086  3.373941e+01  1.021667e+01        0.405948  1.145701e+07
std    3.287267e+00  7.185115e+02     15.891624  8.366470e+01     0.210690  3.979019e+00  7.864318e+00        0.100869  5.332075e+06
min   -2.760000e-01  0.000000e+00     -0.000000  0.000000e+00     7.500000 -9.000000e+00 -3.000000e+00        0.040200  6.058060e+05
25%    4.250000e-02  3.500000e+01      1.628000  1.575000e+02     7.792662  3.364070e+01  3.826300e+00        0.368000  7.847742e+06
50%    1.613000e-01  8.000000e+01      4.467000  2.098000e+02     8.080000  3.455200e+01  8.701000e+00        0.375000  1.135628e+07
75%    5.870000e-01  3.500000e+02     28.667000  2.590000e+02     8.189000  3.501900e+01  1.508100e+01        0.410000  1.563902e+07
max    4.999400e+01  9.000000e+03     46.692000  5.230000e+02     8.480000  5.107340e+01  3.491000e+01        8.665000  2.282467e+07
2025-06-17 23:39:29,762 - INFO - 
Null summary for table casts:
2025-06-17 23:39:29,763 - INFO - 
              Null Count  Percent
bottom depth      543515    47.03
time               38611     3.34
2025-06-17 23:39:33,598 - INFO - 
Null summary for table features:
2025-06-17 23:39:33,599 - INFO - 
                Null Count  Percent
ph                30689357    99.99
nitrate           30678876    99.96
transmissivity    30437333    99.17
chlorophyll       28478293    92.79
oxygen            23592785    76.87
salinity           2001861     6.52
temperature        1172793     3.82
depth              1154879     3.76
2025-06-17 23:39:34,571 - INFO - 
Summary for table: features_clean
2025-06-17 23:39:35,072 - INFO - 
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 2213716 entries, 0 to 2213715
Data columns (total 12 columns):
 #   Column          Dtype         
---  ------          -----         
 0   chlorophyll     float64       
 1   depth           float64       
 2   nitrate         float64       
 3   oxygen          float64       
 4   ph              float64       
 5   salinity        float64       
 6   temperature     float64       
 7   transmissivity  float64       
 8   cast            int32         
 9   timestamp       datetime64[us]
 10  latitude        object        
 11  longitude       object        
dtypes: datetime64[us](1), float64(8), int32(1), object(2)
memory usage: 194.2+ MB

2025-06-17 23:39:35,604 - INFO - 
         chlorophyll         depth       nitrate        oxygen           ph      salinity   temperature  transmissivity          cast                   timestamp latitude longitude
count   2.213716e+06  2.213716e+06  13133.000000  1.648623e+06  1491.000000  2.203080e+06  2.209465e+06             0.0  2.213716e+06                     2213716  2213716   2213716
unique           NaN           NaN           NaN           NaN          NaN           NaN           NaN             NaN           NaN                         NaN    51947     57446
top              NaN           NaN           NaN           NaN          NaN           NaN           NaN             NaN           NaN                         NaN  47.0000  -52.5867
freq             NaN           NaN           NaN           NaN          NaN           NaN           NaN             NaN           NaN                         NaN    29210      8307
mean    9.665283e-01  3.660700e+02     14.408317  2.185368e+02     8.159097  3.352545e+01  8.308043e+00             NaN  1.412566e+07  2007-01-02 22:23:03.979741      NaN       NaN
min    -2.760000e-01  0.000000e+00     -0.000000  0.000000e+00     7.684692  0.000000e+00 -2.054800e+00             NaN  8.440350e+05         1979-05-23 16:21:00      NaN       NaN
25%     4.250000e-02  3.000000e+01      1.628000  1.761000e+02     8.113000  3.237500e+01  2.051500e+00             NaN  1.074370e+07  2001-07-23 13:50:03.120000      NaN       NaN
50%     1.613000e-01  7.500000e+01      4.467000  2.217000e+02     8.164000  3.406300e+01  6.890000e+00             NaN  1.319069e+07         2007-03-23 17:46:12      NaN       NaN
75%     5.870000e-01  2.750000e+02     28.667000  2.820000e+02     8.250000  3.486270e+01  1.184000e+01             NaN  1.773480e+07         2012-08-03 09:33:00      NaN       NaN
max     4.999400e+01  6.000000e+03     46.692000  4.786490e+02     8.480000  4.061300e+01  3.327300e+01             NaN  2.282467e+07         2024-03-28 05:31:12      NaN       NaN
std     3.287267e+00  7.648320e+02     15.891624  8.731364e+01     0.121001  2.178683e+00  7.874825e+00             NaN  4.318360e+06                         NaN      NaN       NaN
2025-06-17 23:39:36,220 - INFO - 
Null summary for table features_clean:
2025-06-17 23:39:36,221 - INFO - 
                Null Count  Percent
transmissivity     2213716   100.00
ph                 2212225    99.93
nitrate            2200583    99.41
oxygen              565093    25.53
salinity             10636     0.48
temperature           4251     0.19
2025-06-17 23:39:36,763 - INFO - Saved null heatmap to /home/bhan/projects/wod/scripts/../stats/null_heatmap/features_clean_month.png
2025-06-17 23:39:36,770 - INFO - Dropped column 'transmissivity' from features_clean
2025-06-17 23:39:36,774 - INFO - Dropped column 'ph' from features_clean
2025-06-17 23:39:36,780 - INFO - Dropped column 'nitrate' from features_clean
2025-06-17 23:39:36,967 - INFO - Dropped rows with invalid lat/lon from table features_clean
2025-06-17 23:39:41,318 - INFO - Saved distribution plot for chlorophyll to /home/bhan/projects/wod/scripts/../stats/distributions/distribution_features_clean_chlorophyll.png
2025-06-17 23:39:45,748 - INFO - Saved log scaleddistribution plot for chlorophyll to /home/bhan/projects/wod/scripts/../stats/distributions/log_scaled_distribution_features_clean_chlorophyll.png
2025-06-17 23:39:45,774 - INFO - Outliers in chlorophyll: 267920 out of 2213706 (12.10%)
2025-06-17 23:39:47,545 - INFO - Saved box plot for chlorophyll to /home/bhan/projects/wod/scripts/../stats/distributions/boxplot_features_clean_chlorophyll.png
2025-06-17 23:39:47,689 - INFO - Saved bar plot for chlorophyll to /home/bhan/projects/wod/scripts/../stats/distributions/barplot_features_clean_chlorophyll.png
2025-06-17 23:39:50,742 - INFO - Saved violin plot for chlorophyll to /home/bhan/projects/wod/scripts/../stats/distributions/violinplot_features_clean_chlorophyll.png
2025-06-17 23:39:55,043 - INFO - Saved distribution plot for depth to /home/bhan/projects/wod/scripts/../stats/distributions/distribution_features_clean_depth.png
2025-06-17 23:39:59,375 - INFO - Saved log scaleddistribution plot for depth to /home/bhan/projects/wod/scripts/../stats/distributions/log_scaled_distribution_features_clean_depth.png
2025-06-17 23:39:59,401 - INFO - Outliers in depth: 337644 out of 2213706 (15.25%)
2025-06-17 23:40:01,191 - INFO - Saved box plot for depth to /home/bhan/projects/wod/scripts/../stats/distributions/boxplot_features_clean_depth.png
2025-06-17 23:40:01,337 - INFO - Saved bar plot for depth to /home/bhan/projects/wod/scripts/../stats/distributions/barplot_features_clean_depth.png
2025-06-17 23:40:05,687 - INFO - Saved violin plot for depth to /home/bhan/projects/wod/scripts/../stats/distributions/violinplot_features_clean_depth.png
2025-06-17 23:40:09,116 - INFO - Saved distribution plot for oxygen to /home/bhan/projects/wod/scripts/../stats/distributions/distribution_features_clean_oxygen.png
2025-06-17 23:40:12,505 - INFO - Saved log scaleddistribution plot for oxygen to /home/bhan/projects/wod/scripts/../stats/distributions/log_scaled_distribution_features_clean_oxygen.png
2025-06-17 23:40:12,526 - INFO - Outliers in oxygen: 34267 out of 1648613 (2.08%)
2025-06-17 23:40:13,468 - INFO - Saved box plot for oxygen to /home/bhan/projects/wod/scripts/../stats/distributions/boxplot_features_clean_oxygen.png
2025-06-17 23:40:13,606 - INFO - Saved bar plot for oxygen to /home/bhan/projects/wod/scripts/../stats/distributions/barplot_features_clean_oxygen.png
2025-06-17 23:40:15,880 - INFO - Saved violin plot for oxygen to /home/bhan/projects/wod/scripts/../stats/distributions/violinplot_features_clean_oxygen.png
2025-06-17 23:40:20,118 - INFO - Saved distribution plot for salinity to /home/bhan/projects/wod/scripts/../stats/distributions/distribution_features_clean_salinity.png
2025-06-17 23:40:24,494 - INFO - Saved log scaleddistribution plot for salinity to /home/bhan/projects/wod/scripts/../stats/distributions/log_scaled_distribution_features_clean_salinity.png
2025-06-17 23:40:24,518 - INFO - Outliers in salinity: 61757 out of 2203070 (2.80%)
2025-06-17 23:40:25,842 - INFO - Saved box plot for salinity to /home/bhan/projects/wod/scripts/../stats/distributions/boxplot_features_clean_salinity.png
2025-06-17 23:40:25,990 - INFO - Saved bar plot for salinity to /home/bhan/projects/wod/scripts/../stats/distributions/barplot_features_clean_salinity.png
2025-06-17 23:40:29,156 - INFO - Saved violin plot for salinity to /home/bhan/projects/wod/scripts/../stats/distributions/violinplot_features_clean_salinity.png
2025-06-17 23:40:33,521 - INFO - Saved distribution plot for temperature to /home/bhan/projects/wod/scripts/../stats/distributions/distribution_features_clean_temperature.png
2025-06-17 23:40:39,264 - INFO - Saved log scaleddistribution plot for temperature to /home/bhan/projects/wod/scripts/../stats/distributions/log_scaled_distribution_features_clean_temperature.png
2025-06-17 23:40:39,287 - INFO - Outliers in temperature: 70525 out of 2209455 (3.19%)
2025-06-17 23:40:40,552 - INFO - Saved box plot for temperature to /home/bhan/projects/wod/scripts/../stats/distributions/boxplot_features_clean_temperature.png
2025-06-17 23:40:40,697 - INFO - Saved bar plot for temperature to /home/bhan/projects/wod/scripts/../stats/distributions/barplot_features_clean_temperature.png
2025-06-17 23:40:43,938 - INFO - Saved violin plot for temperature to /home/bhan/projects/wod/scripts/../stats/distributions/violinplot_features_clean_temperature.png
2025-06-17 23:40:43,938 - INFO - 
Summary for table: features_clean
2025-06-17 23:40:44,277 - INFO - 
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 2213706 entries, 0 to 2213705
Data columns (total 9 columns):
 #   Column       Dtype         
---  ------       -----         
 0   chlorophyll  float64       
 1   depth        float64       
 2   oxygen       float64       
 3   salinity     float64       
 4   temperature  float64       
 5   cast         int32         
 6   timestamp    datetime64[us]
 7   latitude     object        
 8   longitude    object        
dtypes: datetime64[us](1), float64(5), int32(1), object(2)
memory usage: 143.6+ MB

2025-06-17 23:40:44,730 - INFO - 
         chlorophyll         depth        oxygen      salinity   temperature          cast                   timestamp latitude longitude
count   2.213706e+06  2.213706e+06  1.648613e+06  2.203070e+06  2.209455e+06  2.213706e+06                     2213706  2213706   2213706
unique           NaN           NaN           NaN           NaN           NaN           NaN                         NaN    51947     57445
top              NaN           NaN           NaN           NaN           NaN           NaN                         NaN  47.0000  -52.5867
freq             NaN           NaN           NaN           NaN           NaN           NaN                         NaN    29210      8307
mean    9.665277e-01  3.660715e+02  2.185370e+02  3.352544e+01  8.307959e+00  1.412566e+07  2007-01-02 22:36:01.496802      NaN       NaN
min    -2.760000e-01  0.000000e+00  0.000000e+00  0.000000e+00 -2.054800e+00  8.440350e+05         1979-05-23 16:21:00      NaN       NaN
25%     4.250000e-02  3.000000e+01  1.761000e+02  3.237500e+01  2.051500e+00  1.074370e+07         2001-07-23 14:58:48      NaN       NaN
50%     1.612550e-01  7.500000e+01  2.217000e+02  3.406300e+01  6.890000e+00  1.319069e+07         2007-03-23 17:46:12      NaN       NaN
75%     5.870000e-01  2.750000e+02  2.820000e+02  3.486270e+01  1.184000e+01  1.773480e+07         2012-08-03 09:33:00      NaN       NaN
max     4.999400e+01  6.000000e+03  4.786490e+02  4.061300e+01  3.327300e+01  2.282467e+07         2024-03-28 05:31:12      NaN       NaN
std     3.287273e+00  7.648334e+02  8.731386e+01  2.178679e+00  7.874741e+00  4.318369e+06                         NaN      NaN       NaN
2025-06-17 23:40:45,142 - INFO - 
Null summary for table features_clean:
2025-06-17 23:40:45,142 - INFO - 
             Null Count  Percent
oxygen           565093    25.53
salinity          10636     0.48
temperature        4251     0.19
2025-06-17 23:40:45,661 - INFO - Saved null heatmap to /home/bhan/projects/wod/scripts/../stats/null_heatmap/features_clean_month.png
2025-06-17 23:40:48,470 - INFO - Finished hierarchical imputation for oxygen: {'day + lat/lon': 4076, 'month + lat/lon': 10777, 'lat/lon': 280295, 'month': 267277, 'global': 2668} (Filled 565093 out of 565093)
2025-06-17 23:40:48,566 - INFO - Finished hierarchical imputation for salinity: {'day + lat/lon': 737, 'month + lat/lon': 51, 'lat/lon': 5519, 'month': 4329, 'global': 0} (Filled 10636 out of 10636)
2025-06-17 23:40:48,633 - INFO - Finished hierarchical imputation for temperature: {'day + lat/lon': 345, 'month + lat/lon': 18, 'lat/lon': 1037, 'month': 2851, 'global': 0} (Filled 4251 out of 4251)
2025-06-17 23:40:48,808 - INFO - 
Summary for table: features_imputed
2025-06-17 23:40:49,210 - INFO - 
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 2213706 entries, 0 to 2213705
Data columns (total 9 columns):
 #   Column       Dtype         
---  ------       -----         
 0   chlorophyll  float64       
 1   depth        float64       
 2   oxygen       float64       
 3   salinity     float64       
 4   temperature  float64       
 5   cast         int32         
 6   timestamp    datetime64[us]
 7   latitude     object        
 8   longitude    object        
dtypes: datetime64[us](1), float64(5), int32(1), object(2)
memory usage: 143.6+ MB

2025-06-17 23:40:49,626 - INFO - 
         chlorophyll         depth        oxygen      salinity   temperature          cast                   timestamp latitude longitude
count   2.213706e+06  2.213706e+06  2.213706e+06  2.213706e+06  2.213706e+06  2.213706e+06                     2213706  2213706   2213706
unique           NaN           NaN           NaN           NaN           NaN           NaN                         NaN    51947     57445
top              NaN           NaN           NaN           NaN           NaN           NaN                         NaN  47.0000  -52.5867
freq             NaN           NaN           NaN           NaN           NaN           NaN                         NaN    29210      8307
mean    9.665277e-01  3.660715e+02  2.217655e+02  3.352404e+01  8.309771e+00  1.412566e+07  2007-01-02 22:36:01.496802      NaN       NaN
min    -2.760000e-01  0.000000e+00  0.000000e+00  0.000000e+00 -2.054800e+00  8.440350e+05         1979-05-23 16:21:00      NaN       NaN
25%     4.250000e-02  3.000000e+01  1.830000e+02  3.237500e+01  2.058800e+00  1.074370e+07         2001-07-23 14:58:48      NaN       NaN
50%     1.612550e-01  7.500000e+01  2.260409e+02  3.405680e+01  6.891000e+00  1.319069e+07         2007-03-23 17:46:12      NaN       NaN
75%     5.870000e-01  2.750000e+02  2.764870e+02  3.485900e+01  1.183500e+01  1.773480e+07         2012-08-03 09:33:00      NaN       NaN
max     4.999400e+01  6.000000e+03  4.786490e+02  4.061300e+01  3.327300e+01  2.282467e+07         2024-03-28 05:31:12      NaN       NaN
std     3.287273e+00  7.648334e+02  8.004710e+01  2.175065e+00  7.870442e+00  4.318369e+06                         NaN      NaN       NaN
2025-06-17 23:40:50,007 - INFO - 
Null summary for table features_imputed:
2025-06-17 23:40:50,007 - INFO - 
Empty DataFrame
Columns: [Null Count, Percent]
Index: []
2025-06-17 23:40:50,459 - INFO - Saved null heatmap to /home/bhan/projects/wod/scripts/../statsnull_heatmap/features_imputed_month.png
2025-06-17 23:40:50,486 - INFO - Timestamp distribution for features_imputed (granularity=month):
         start_date            end_date  total_records  active_days  active_months  active_years
1979-05-23 16:21:00 2024-03-28 05:31:12        2213706         8942            427            46
2025-06-17 23:40:50,793 - INFO - Saved timestamp distribution plot to /home/bhan/projects/wod/scripts/../stats/distributions/timestamp_distribution_features_imputed_month.png
2025-06-17 23:41:18,171 - INFO - Saved lat-lon world map plot to /home/bhan/projects/wod/scripts/../stats/distributions/lat_lon_distribution_features_imputed.png
